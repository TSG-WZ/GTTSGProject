
@{
    Layout = null;
}

@model DTTSG_Model.BookInfo
@using DTTSG_Model

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>图书详情</title>
    <link rel="stylesheet" href="~/lib/layui-v2.5.5/css/layui.css" media="all">
    <style>
        #Contents {
            margin-bottom:100px;
        }#Contents span{
             display:block;
         }#Contents a{
              width:140px;
          }
        #BookName{
            font-size:45px
        }
        #B_StatuName{
            color:darkgray;
            font-size:20px;
            font-family:YouYuan;
        }
        #B_TypeName {
            font-weight: 600;
            font-size: 20px;
            font-family: YouYuan;
            padding-top:5px;
        }
        .pub {
            font-weight: 600;
            font-size: 20px;
            font-family: YouYuan;
            padding-top: 30px;
        }
        .pub2 {
            font-size: 20px;
            font-family: YouYuan;
            padding-top: 5px;
        }
        #Money {
            font-size: 40px;
            font-family: YouYuan;
            padding: 40px 0px;
        }#Money label{
             color:darkgray;
             font-size:25px;
         }
    </style>
</head>
<body>
    <div style="margin:30px">
        <a href="javascript:;" onclick="window.history.back(); //返回上一页" style="font-size:16px;">《&nbsp;&nbsp;&nbsp;返回上一页</a>
    </div>

    <div class="layui-container">
        <div class="layui-row">
            <div class="layui-col-md5 layui-col-xs12">
                <img src="@Model.ImageInfo.ImageLink" width="100%" height="100%"/>
            </div>
            <div class="layui-col-md6 layui-col-xs12" style="text-align:center" id="Contents">
                <br />
                <span id="BookName">@Model.BookName</span><br />
                <span id="B_StatuName">状态:@Model.BookStatu.B_StatuName</span>
                <span id="B_TypeName">图书类型:@Model.BookType.B_TypeName</span>
                <span class="pub">出版社:@Model.BookPublic</span>
                <span class="pub2">作者:@Model.BookAuthor</span>
                <span class="pub2">出版时间:@Model.BookPubtime.ToLongDateString()</span>
                <span class="pub">存书地点:@Model.MechanInfo.MechanAddress</span>
                <span id="Money"><strong>￥ @Model.BookPrice <label>RMB</label></strong></span>
                @{if (Model.B_StatuId == 1)
                    {
                        if (string.IsNullOrWhiteSpace((Session["User"] as UserInfo).OpenId))
                        {
                              <a href="javascript:;" id="queding" class="layui-btn layui-btn-normal layui-btn-lg">借阅</a>
                        }
                        else
                        {
                          
                            <a href="javascript:;" id="reward" class="layui-btn layui-btn-normal layui-btn-lg">预约</a>
                        }
                    }
                }
                <a href="javascript:;" class="layui-btn layui-btn-normal layui-btn-lg" id="collect">收藏</a>
            </div>
        </div>
    </div>
    <script src="~/lib/layui-v2.5.5/layui.js"></script>

    <script>
        layui.use(['layer'], function () {
            var layer = layui.layer,
                $ = layui.jquery;

            //电脑端借阅图书
            $("#queding").click(function () {
                $.ajax({
                    url: "/Book/BorrowBook",
                    data: { "bookId": @Model.BookId },
                    dataType: "json",
                    type: "post",
                    success: function (data) {
                        if (data.Status == 1) {
                            //alert(data);
                            layer.msg(data.Msg, {
                                icon: 1,
                                time: 2000 //2秒关闭（如果不配置，默认是3秒）
                            }, function () {
                                window.location = '/Book/BookList';
                            });
                        }
                        else {
                            layer.msg("未知问题,请联系管理员!", { icon: 3, time: 2000 });   //其他问题
                        }
                    }
                }); //ajax结束
            });

            //手机端确认预约
            $("#reward").click(function () {
                $.ajax({
                    url: "/Forward/ForwardBook",
                    data: { "bookId": @Model.BookId },
                    dataType: "json",
                    type: "POST",
                    success: function (data) {
                        if (data.Status == 1) {
                            layer.msg(data.Msg, {
                                icon: 1,
                                time: 2000 //2秒关闭（如果不配置，默认是3秒）
                            }, function () {
                                window.location = '/Book/BookList';
                            });
                        } else if (data.Status == -1) {
                            layer.msg(data.Msg, {
                                icon: 2,
                                time: 2000
                            });
                        } else if (data.Status == 0) {
                            layer.msg(data.Msg, {
                                icon: 2,
                                time: 2000
                            });
                        }
                        else {
                            layer.msg("未知问题,请联系管理员!", { icon: 3, time: 2000 });   //其他问题
                        }
                    }
                }); //ajax结束
            }); 

            //添加收藏(双端)
            $("#collect").click(function () {
                $.ajax({
                    url: "/Collect/AddCollect",
                    data: { "bookId": @Model.BookId },
                    dataType: "json",
                    type: "post",
                    success: function (data) {
                        if (data.Status == 1) {
                            //alert(data);
                            layer.msg(data.Msg, {
                                icon: 1,
                                time: 2000 //2秒关闭（如果不配置，默认是3秒）
                            }, function () {
                                window.location = '/Book/BookList';
                                });
                        } else if (data.Status == -1) {
                            layer.msg(data.Msg, {
                                icon: 2,
                                time: 2000 //2秒关闭（如果不配置，默认是3秒）
                            });
                        }
                        else {
                            layer.msg("未知问题,请联系管理员!", { icon: 3, time: 2000 });   //其他问题
                        }
                    }
                }); //ajax结束
            });

        });
    </script>
</body>
</html>
